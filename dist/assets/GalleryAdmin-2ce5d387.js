import{c as k,u as D,r as c,a as o,j as e,a3 as j,B as g,Q as N,F,T as C}from"./index-084b20c5.js";import{C as I}from"./calendar-0f9c51bc.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=k("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),S=()=>{const{toast:r}=D(),l=c.useRef(null),[d,p]=c.useState([]),[w,u]=c.useState(!0),[m,f]=c.useState(!1);c.useEffect(()=>{x()},[]);const x=async()=>{try{u(!0);const{data:a,error:s}=await o.storage.from("gallery-images").list("",{limit:100,offset:0,sortBy:{column:"created_at",order:"desc"}});if(s)throw s;const i=a.filter(t=>t.name!==".emptyFolderPlaceholder").map(t=>{var n;const{data:{publicUrl:h}}=o.storage.from("gallery-images").getPublicUrl(t.name);return{id:t.id,name:t.name,image_url:h,created_at:t.created_at,size:(n=t.metadata)==null?void 0:n.size}});p(i)}catch(a){console.error("Error fetching gallery items:",a),r({title:"Erro",description:"Falha ao carregar itens da galeria.",variant:"destructive"})}finally{u(!1)}},b=async a=>{var i;const s=(i=a.target.files)==null?void 0:i[0];if(s){if(!s.type.startsWith("image/")){r({title:"Arquivo inválido",description:"Por favor selecione apenas arquivos de imagem.",variant:"destructive"});return}try{f(!0);const t=s.name.split(".").pop(),h=s.name.replace(/[^a-zA-Z0-9]/g,"_"),n=`${Date.now()}_${h}.${t}`,{error:v}=await o.storage.from("gallery-images").upload(n,s);if(v)throw v;r({title:"Sucesso",description:"Imagem enviada com sucesso!"}),x()}catch(t){console.error("Error uploading image:",t),r({title:"Erro no envio",description:"Não foi possível enviar a imagem. Verifique as permissões.",variant:"destructive"})}finally{f(!1),l.current&&(l.current.value="")}}},y=async a=>{if(window.confirm("Tem certeza que deseja excluir esta imagem?"))try{p(d.filter(i=>i.name!==a));const{error:s}=await o.storage.from("gallery-images").remove([a]);if(s)throw s;r({title:"Excluído",description:"Imagem removida da galeria."})}catch(s){console.error("Error deleting item:",s),r({title:"Erro",description:"Falha ao excluir imagem.",variant:"destructive"}),x()}},E=a=>new Date(a).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 bg-[#111] p-6 rounded-lg border border-white/5",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-3",children:[e.jsx(j,{className:"w-6 h-6 text-[#5FD068]"}),"Gerenciamento da Galeria"]}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Adicione ou remova imagens da galeria."})]}),e.jsxs("div",{children:[e.jsx("input",{type:"file",ref:l,className:"hidden",accept:"image/*",onChange:b}),e.jsxs(g,{onClick:()=>{var a;return(a=l.current)==null?void 0:a.click()},disabled:m,className:"bg-[#5FD068] text-black hover:bg-[#4ab553]",children:[m?e.jsx(N,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(_,{className:"w-4 h-4 mr-2"}),m?"Enviando...":"Nova Imagem"]})]})]}),e.jsx("div",{className:"bg-slate-900/30 border border-slate-800/50 rounded-lg overflow-hidden min-h-[400px]",children:w?e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-slate-400",children:[e.jsx(N,{className:"w-8 h-8 animate-spin mb-4 text-[#5FD068]"}),e.jsx("p",{children:"Carregando imagens..."})]}):d.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-slate-500",children:[e.jsx(j,{className:"w-12 h-12 mb-4 opacity-50"}),e.jsx("p",{className:"text-lg",children:"Galeria vazia"}),e.jsx(g,{variant:"link",onClick:()=>{var a;return(a=l.current)==null?void 0:a.click()},className:"text-[#5FD068]",children:"Adicione a primeira imagem"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-black/40 text-xs font-bold text-slate-400 uppercase border-b border-white/5",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4 w-[100px]",children:"Preview"}),e.jsx("th",{className:"p-4",children:"Nome do Arquivo"}),e.jsx("th",{className:"p-4 w-[200px]",children:"Data de Envio"}),e.jsx("th",{className:"p-4 w-[100px] text-right",children:"Ações"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-800/30",children:d.map(a=>e.jsxs("tr",{className:"hover:bg-slate-800/30 transition-colors",children:[e.jsx("td",{className:"p-4",children:e.jsx("div",{className:"w-16 h-12 rounded overflow-hidden bg-black/50 border border-white/10",children:e.jsx("img",{src:a.image_url,alt:a.name,className:"w-full h-full object-cover"})})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2 text-white",children:[e.jsx(F,{className:"w-4 h-4 text-slate-500"}),e.jsx("span",{className:"truncate max-w-[200px] md:max-w-[300px]",children:a.name})]})}),e.jsx("td",{className:"p-4 text-slate-400",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"w-4 h-4 text-slate-600"}),E(a.created_at)]})}),e.jsx("td",{className:"p-4 text-right",children:e.jsx(g,{size:"icon",variant:"ghost",onClick:()=>y(a.name),className:"text-red-400 hover:text-red-300 hover:bg-red-900/20 h-8 w-8",children:e.jsx(C,{className:"w-4 h-4"})})})]},a.id))})]})})})]})};export{S as default};
