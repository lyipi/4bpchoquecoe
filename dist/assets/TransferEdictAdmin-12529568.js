import{c as v,g as E,u as S,r as a,a as D,j as e,_ as f,$ as F,w as T,X as A,B as j,a0 as N,d as _,a1 as z,F as L,U as P,a2 as g,m as B}from"./index-084b20c5.js";import{C as R}from"./calendar-0f9c51bc.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=v("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w=v("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),U=()=>{const{hasRole:l}=E(),{toast:o}=S(),[b,y]=a.useState([]),[d,i]=a.useState(!0),[x,m]=a.useState(null),[n,C]=a.useState(""),r=a.useCallback(async()=>{i(!0),m(null);try{const{data:s,error:t}=await D.from("transfer_edict").select("*").order("created_at",{ascending:!1});if(t)throw t;y(s||[])}catch(s){console.error("Error fetching transfer edicts:",s),m("Falha ao carregar os editais. Por favor, tente novamente."),o({title:"Erro",description:"Não foi possível carregar os editais de transferência.",variant:"destructive"})}finally{i(!1)}},[o]);if(a.useEffect(()=>{l(["Administrativos","Super Administrativo"])?r():i(!1)},[l,r]),!l(["Administrativos","Super Administrativo"]))return e.jsxs("div",{className:"flex flex-col items-center justify-center p-8 text-center bg-red-900/10 border border-red-900/30 rounded-lg",children:[e.jsx(f,{className:"w-12 h-12 text-red-500 mb-4"}),e.jsx("h2",{className:"text-xl font-bold text-red-400",children:"Acesso Negado"}),e.jsx("p",{className:"text-red-300/70",children:"Você não tem permissão para visualizar os editais de transferência."})]});const c=b.filter(s=>{var h,p,u;const t=n.toLowerCase();return(((h=s.full_name)==null?void 0:h.toLowerCase())||"").includes(t)||((p=s.cpf)==null?void 0:p.includes(t))||(((u=s.discord_id)==null?void 0:u.toLowerCase())||"").includes(t)}),k=s=>s?new Date(s).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 bg-[#111] p-6 rounded-lg border border-white/5",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-3",children:[e.jsx(F,{className:"w-6 h-6 text-[#5FD068]"}),"Editais de Transferência"]}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Gerenciamento e visualização de solicitações de transferência."})]}),e.jsxs("div",{className:"flex items-center gap-3 w-full md:w-auto",children:[e.jsxs("div",{className:"relative w-full md:w-64",children:[e.jsx(T,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx(A,{placeholder:"Buscar por nome, CPF ou Discord...",value:n,onChange:s=>C(s.target.value),className:"pl-10 bg-black/50 border-white/10 text-white placeholder:text-slate-500 focus:ring-[#5FD068]"})]}),e.jsx(j,{variant:"outline",size:"icon",onClick:r,className:"border-white/10 hover:bg-white/5 hover:text-[#5FD068]",title:"Atualizar lista",children:e.jsx(N,{className:_("w-4 h-4",d&&"animate-spin")})})]})]}),e.jsx("div",{className:"bg-slate-900/30 border border-slate-800/50 rounded-lg overflow-hidden min-h-[400px]",children:d?e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-slate-400",children:[e.jsx(N,{className:"w-8 h-8 animate-spin mb-4 text-[#5FD068]"}),e.jsx("p",{children:"Carregando editais..."})]}):x?e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-red-400",children:[e.jsx(z,{className:"w-10 h-10 mb-4"}),e.jsx("p",{className:"mb-4",children:x}),e.jsx(j,{onClick:r,variant:"outline",className:"border-red-900/30 hover:bg-red-900/10",children:"Tentar Novamente"})]}):c.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-slate-500",children:[e.jsx(L,{className:"w-12 h-12 mb-4 opacity-50"}),e.jsx("p",{className:"text-lg",children:"Nenhum edital encontrado"}),n&&e.jsx("p",{className:"text-sm mt-2",children:"Tente buscar com outros termos."})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-black/40 text-xs font-bold text-slate-400 uppercase border-b border-white/5",children:e.jsxs("tr",{children:[e.jsxs("th",{className:"p-4 whitespace-nowrap",children:[e.jsx(P,{className:"w-3 h-3 inline mr-1"})," Nome / CPF"]}),e.jsxs("th",{className:"p-4 whitespace-nowrap",children:[e.jsx(f,{className:"w-3 h-3 inline mr-1"})," Patente / Unidade"]}),e.jsxs("th",{className:"p-4 whitespace-nowrap",children:[e.jsx(g,{className:"w-3 h-3 inline mr-1"})," Contato"]}),e.jsxs("th",{className:"p-4 w-1/3 min-w-[300px]",children:[e.jsx(w,{className:"w-3 h-3 inline mr-1"})," Justificativa"]}),e.jsxs("th",{className:"p-4 whitespace-nowrap text-right",children:[e.jsx(R,{className:"w-3 h-3 inline mr-1"})," Data Envio"]})]})}),e.jsx("tbody",{className:"divide-y divide-slate-800/30",children:c.map(s=>e.jsxs(B.tr,{initial:{opacity:0},animate:{opacity:1},className:"hover:bg-slate-800/30 transition-colors group",children:[e.jsxs("td",{className:"p-4 align-top",children:[e.jsx("div",{className:"font-medium text-white",children:s.full_name}),e.jsxs("div",{className:"text-xs text-slate-500 font-mono mt-1 flex items-center gap-1",children:[e.jsx(H,{className:"w-3 h-3"})," ",s.cpf]})]}),e.jsxs("td",{className:"p-4 align-top",children:[e.jsx("div",{className:"text-slate-300",children:s.rank}),e.jsx("div",{className:"text-xs text-slate-500 mt-1 bg-slate-900/50 inline-block px-2 py-0.5 rounded",children:s.unit})]}),e.jsx("td",{className:"p-4 align-top",children:e.jsxs("div",{className:"text-slate-400 text-xs space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",title:"Telefone",children:[e.jsx(g,{className:"w-3 h-3"})," ",s.phone]}),e.jsxs("div",{className:"flex items-center gap-2",title:"Discord",children:[e.jsx(w,{className:"w-3 h-3"})," ",s.discord_id]})]})}),e.jsx("td",{className:"p-4 align-top",children:e.jsx("p",{className:"text-slate-300 text-xs leading-relaxed max-h-[100px] overflow-y-auto pr-2 custom-scrollbar",children:s.justification})}),e.jsx("td",{className:"p-4 align-top text-right text-slate-500 font-mono text-xs",children:k(s.created_at)})]},s.id))})]})})}),e.jsxs("div",{className:"text-xs text-slate-600 text-right",children:["Total de registros: ",c.length]})]})};export{U as default};
