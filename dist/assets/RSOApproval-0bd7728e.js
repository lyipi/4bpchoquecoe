import{R as d,j as e,d as i,u as w,r as c,a as j,m as f,B as o,C,e as y}from"./index-084b20c5.js";import{C as R,a as k}from"./circle-x-ff72a381.js";const g=d.forwardRef(({className:a,...t},r)=>e.jsx("div",{ref:r,className:i("rounded-lg border bg-card text-card-foreground shadow-sm",a),...t}));g.displayName="Card";const S=d.forwardRef(({className:a,...t},r)=>e.jsx("div",{ref:r,className:i("flex flex-col space-y-1.5 p-6",a),...t}));S.displayName="CardHeader";const A=d.forwardRef(({className:a,...t},r)=>e.jsx("h2",{ref:r,className:i("text-2xl font-semibold leading-none tracking-tight",a),...t}));A.displayName="CardTitle";const D=d.forwardRef(({className:a,...t},r)=>e.jsx("p",{ref:r,className:i("text-sm text-muted-foreground",a),...t}));D.displayName="CardDescription";const N=d.forwardRef(({className:a,...t},r)=>e.jsx("div",{ref:r,className:i("p-6 pt-0",a),...t}));N.displayName="CardContent";const E=d.forwardRef(({className:a,...t},r)=>e.jsx("div",{ref:r,className:i("flex items-center p-6 pt-0",a),...t}));E.displayName="CardFooter";const F=()=>{const{toast:a}=w(),[t,r]=c.useState([]),[u,p]=c.useState(!0),[l,b]=c.useState(null);c.useEffect(()=>{h()},[]);const h=async()=>{p(!0);const{data:s,error:n}=await j.from("rso").select("*").order("created_at",{ascending:!1});n?a({title:"Erro",description:"Erro ao carregar RSOs",variant:"destructive"}):r(s||[]),p(!1)},x=async(s,n)=>{const{error:m}=await j.from("rso").update({status:n}).eq("id",s.id);m?a({title:"Erro",description:"Falha ao atualizar status",variant:"destructive"}):(a({title:"Sucesso",description:`RSO ${n==="approved"?"Aprovado":"Rejeitado"} com sucesso.`}),h())},v=s=>{b(l===s?null:s)};return u?e.jsx("div",{className:"text-white",children:"Carregando RSOs..."}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Gestão de RSOs"}),e.jsxs("div",{className:"grid gap-4",children:[t.length===0&&e.jsx("p",{className:"text-[#a8a9ad]",children:"Nenhum RSO encontrado."}),t.map(s=>e.jsxs(f.div,{initial:{opacity:0},animate:{opacity:1},className:"bg-black/40 border border-[#a8a9ad]/20 rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"p-4 flex flex-col md:flex-row justify-between gap-4 items-start md:items-center",children:[e.jsxs("div",{className:"space-y-1 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-xs px-2 py-0.5 rounded uppercase font-bold ${s.status==="approved"?"bg-green-900 text-green-200":s.status==="rejected"?"bg-red-900 text-red-200":"bg-yellow-900 text-yellow-200"}`,children:s.status==="pending"?"Pendente":s.status==="approved"?"Aprovado":"Rejeitado"}),e.jsx("span",{className:"text-[#5FD068] font-bold",children:s.unit_prefix}),e.jsx("span",{className:"text-xs text-gray-500 ml-2",children:new Date(s.created_at).toLocaleString()})]}),e.jsxs("p",{className:"text-white text-sm",children:[e.jsx("span",{className:"text-[#a8a9ad]",children:"Autor:"})," ",s.author]}),e.jsx("div",{className:"flex items-center gap-2 mt-2",children:e.jsxs(o,{variant:"ghost",size:"sm",className:"h-6 text-xs text-blue-400 p-0 hover:text-blue-300 hover:bg-transparent",onClick:()=>v(s.id),children:[l===s.id?"Ver Menos":"Ver Detalhes"," ",l===s.id?e.jsx(C,{className:"w-3 h-3 ml-1"}):e.jsx(y,{className:"w-3 h-3 ml-1"})]})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsxs(o,{size:"sm",onClick:()=>x(s,"approved"),className:"bg-green-600 hover:bg-green-700 text-white",children:[e.jsx(R,{className:"w-4 h-4 mr-2"})," Aprovar"]}),e.jsxs(o,{size:"sm",variant:"destructive",onClick:()=>x(s,"rejected"),children:[e.jsx(k,{className:"w-4 h-4 mr-2"})," Rejeitar"]})]}),s.status!=="pending"&&e.jsx(o,{size:"sm",variant:"outline",onClick:()=>x(s,"pending"),children:"Reabrir"})]})]}),l===s.id&&e.jsx(f.div,{initial:{height:0},animate:{height:"auto"},className:"bg-slate-900/50 border-t border-slate-800 p-4 text-sm text-slate-300",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsx(g,{className:"bg-black/40 border-slate-700",children:e.jsxs(N,{className:"p-3 space-y-2",children:[e.jsx("p",{className:"font-bold text-white mb-2",children:"Resumo da Apreensão"}),e.jsxs("div",{className:"grid grid-cols-2 gap-y-1",children:[e.jsx("span",{children:"Ocorrências:"})," ",e.jsx("span",{className:"text-white font-mono",children:s.occurrences}),e.jsx("span",{children:"Drogas:"})," ",e.jsx("span",{className:"text-white font-mono",children:s.drugs}),e.jsx("span",{children:"Armas:"})," ",e.jsx("span",{className:"text-white font-mono",children:s.weapons}),e.jsx("span",{children:"Dinheiro:"})," ",e.jsx("span",{className:"text-white font-mono",children:s.marked_money}),e.jsx("span",{children:"Bombas:"})," ",e.jsx("span",{className:"text-white font-mono",children:s.bombs}),e.jsx("span",{children:"Lockpicks:"})," ",e.jsx("span",{className:"text-white font-mono",children:s.lockpicks}),e.jsx("span",{children:"Detidos:"})," ",e.jsx("span",{className:"text-white font-mono",children:s.detained}),e.jsx("span",{children:"Munição:"})," ",e.jsx("span",{className:"text-white font-mono",children:s.ammo||0})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-white mb-1",children:"Membros Envolvidos"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Array.isArray(s.members)?s.members.map((n,m)=>e.jsx("span",{className:"bg-slate-800 text-xs px-2 py-1 rounded border border-slate-700",children:n.name||n.user_id},m)):e.jsx("span",{className:"italic text-slate-500",children:"Sem dados de membros"})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-white mb-1",children:"Ações Realizadas"}),e.jsx("p",{className:"bg-black/30 p-2 rounded border border-slate-800 text-xs italic",children:s.actions||"Nenhuma descrição fornecida."})]})]})]})})]},s.id))]})]})};export{F as default};
