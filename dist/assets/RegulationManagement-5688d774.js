import{c as F,u as R,r as l,a as m,j as e,F as S,B as d,P as _,m as C,S as E,b as T,T as G}from"./index-084b20c5.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f=F("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),A=()=>{const{toast:o}=R(),[n,u]=l.useState([]),[j,h]=l.useState(!0),[N,x]=l.useState(!1),[c,p]=l.useState(null),[a,i]=l.useState({title:"",description:"",url:"",category:"Geral"});l.useEffect(()=>{y()},[]);const y=async()=>{h(!0);try{const{data:t,error:s}=await m.from("admin_settings").select("setting_value").eq("setting_key","regulations").single();s&&s.code!=="PGRST116"?(console.error("Error fetching regulations:",s),o({title:"Erro",description:"Erro ao carregar regulamentos",variant:"destructive"})):t&&t.setting_value?u(t.setting_value):u([])}catch(t){console.error("Unexpected error fetching regulations:",t)}h(!1)},b=async t=>{const{data:s}=await m.from("admin_settings").select("id").eq("setting_key","regulations").single();let r;return s?r=(await m.from("admin_settings").update({setting_value:t,updated_at:new Date().toISOString()}).eq("setting_key","regulations")).error:r=(await m.from("admin_settings").insert({setting_key:"regulations",setting_value:t,updated_at:new Date().toISOString()})).error,r?(console.error(r),o({title:"Erro",description:"Falha ao salvar no banco de dados",variant:"destructive"}),!1):!0},w=async()=>{if(!a.title){o({title:"Erro",description:"Título é obrigatório",variant:"destructive"});return}let t;c?t=n.map(r=>r.id===c.id?{...a,id:c.id}:r):t=[...n,{...a,id:Date.now()}],await b(t)&&(u(t),o({title:c?"Regulamento atualizado":"Regulamento adicionado",variant:"default"}),v())},D=async t=>{if(!confirm("Deseja realmente excluir este regulamento?"))return;const s=n.filter(g=>g.id!==t);await b(s)&&(u(s),o({title:"Regulamento removido",variant:"destructive"}))},k=t=>{p(t),i({title:t.title||"",description:t.description||"",url:t.url||"",category:t.category||"Geral"}),x(!0)},v=()=>{p(null),i({title:"",description:"",url:"",category:"Geral"}),x(!1)};return e.jsxs("div",{className:"space-y-6 bg-[#1a1a1a] p-6 rounded-xl border border-[#a8a9ad]/20",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h3",{className:"text-xl font-bold text-white flex items-center gap-2",children:[e.jsx(S,{className:"w-5 h-5 text-[#5FD068]"})," Gerenciar Regulamentos"]}),e.jsxs(d,{onClick:()=>{v(),x(!0)},className:"bg-[#1a4d2e] hover:bg-[#5FD068] text-white hover:text-black",children:[e.jsx(_,{className:"w-4 h-4 mr-2"})," Novo Regulamento"]})]}),N&&e.jsxs(C.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"bg-black p-4 rounded-lg border border-[#5FD068]/30 space-y-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[#a8a9ad] mb-1 block",children:"Título do Regulamento *"}),e.jsx("input",{value:a.title,onChange:t=>i({...a,title:t.target.value}),className:"w-full bg-[#1a1a1a] border border-[#a8a9ad]/30 rounded p-2 text-white focus:border-[#5FD068] outline-none transition-colors",placeholder:"Ex: Regulamento Interno 2024"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[#a8a9ad] mb-1 block",children:"Categoria"}),e.jsxs("select",{value:a.category,onChange:t=>i({...a,category:t.target.value}),className:"w-full bg-[#1a1a1a] border border-[#a8a9ad]/30 rounded p-2 text-white focus:border-[#5FD068] outline-none",children:[e.jsx("option",{value:"Geral",children:"Geral"}),e.jsx("option",{value:"Operacional",children:"Operacional"}),e.jsx("option",{value:"Administrativo",children:"Administrativo"}),e.jsx("option",{value:"Disciplinar",children:"Disciplinar"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[#a8a9ad] mb-1 block",children:"Descrição"}),e.jsx("textarea",{value:a.description,onChange:t=>i({...a,description:t.target.value}),className:"w-full bg-[#1a1a1a] border border-[#a8a9ad]/30 rounded p-2 text-white h-20 resize-none focus:border-[#5FD068] outline-none",placeholder:"Breve descrição do documento..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[#a8a9ad] mb-1 block",children:"URL do Documento"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex items-center justify-center w-10 bg-[#1a1a1a] border border-[#a8a9ad]/30 rounded-l border-r-0 text-[#a8a9ad]",children:e.jsx(f,{className:"w-4 h-4"})}),e.jsx("input",{value:a.url,onChange:t=>i({...a,url:t.target.value}),placeholder:"https://docs.google.com/...",className:"w-full bg-[#1a1a1a] border border-[#a8a9ad]/30 rounded-r p-2 text-white focus:border-[#5FD068] outline-none"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx(d,{variant:"ghost",onClick:()=>x(!1),className:"text-red-400 hover:text-red-300 hover:bg-red-900/20",children:"Cancelar"}),e.jsxs(d,{onClick:w,className:"bg-[#5FD068] text-black hover:bg-[#4ab853]",children:[e.jsx(E,{className:"w-4 h-4 mr-2"})," ",c?"Salvar Alterações":"Criar Regulamento"]})]})]}),j?e.jsx("div",{className:"text-center py-8 text-[#a8a9ad] animate-pulse",children:"Carregando regulamentos..."}):e.jsxs("div",{className:"space-y-3",children:[n.length===0&&e.jsx("div",{className:"text-center py-8 text-[#a8a9ad] italic bg-black/30 rounded border border-white/5",children:"Nenhum regulamento cadastrado."}),n.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-black/40 rounded border border-[#a8a9ad]/10 hover:border-[#5FD068]/30 transition-all group",children:[e.jsxs("div",{className:"overflow-hidden flex-1 mr-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded uppercase font-bold tracking-wider ${t.category==="Operacional"?"bg-red-900/30 text-red-400":t.category==="Administrativo"?"bg-blue-900/30 text-blue-400":"bg-[#5FD068]/20 text-[#5FD068]"}`,children:t.category}),e.jsx("p",{className:"font-bold text-white truncate text-sm",children:t.title})]}),e.jsx("p",{className:"text-xs text-[#a8a9ad] truncate mb-1",children:t.description||"Sem descrição"}),t.url&&e.jsxs("a",{href:t.url,target:"_blank",rel:"noreferrer",className:"text-xs text-[#5FD068] hover:underline truncate inline-flex items-center gap-1 opacity-70 hover:opacity-100",children:[e.jsx(f,{className:"w-3 h-3"})," Acessar Documento"]})]}),e.jsxs("div",{className:"flex gap-2 flex-shrink-0 opacity-100 md:opacity-0 md:group-hover:opacity-100 transition-opacity",children:[e.jsx(d,{size:"icon",variant:"ghost",onClick:()=>k(t),className:"h-8 w-8 text-[#5FD068] hover:bg-[#5FD068]/10",children:e.jsx(T,{className:"w-4 h-4"})}),e.jsx(d,{size:"icon",variant:"ghost",onClick:()=>D(t.id),className:"h-8 w-8 text-red-500 hover:bg-red-900/20",children:e.jsx(G,{className:"w-4 h-4"})})]})]},t.id))]})]})};export{A as default};
